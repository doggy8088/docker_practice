## 21.2 GitHub Actions

GitHub [Actions](https://github.com/features/actions) 是 GitHub 推出的一款 CI/CD 工具。

我們可以在每個 `job` 的 `step` 中使用 Docker 執行建立步驟。

## 21.2.1 最小可用範例

在倉庫根目錄建立 `/.github/workflows/ci.yml`：

```yaml
name: CI

on:
  push:
  pull_request:

permissions:
  contents: read

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: docker/setup-buildx-action@v3
      - uses: docker/build-push-action@v6
        with:
          context: .
          push: false
          tags: local/test:ci
```

該範例會在 GitHub Actions 中建立當前倉庫的 Docker 映象（不推送到 registry）。

## 21.2.2 最佳實踐

* 固定 action 的主版本（例如 `@v4` / `@v6`），避免使用 `@master` 這類浮動引用。
* 設定最小許可權（例如 `contents: read`），需要寫入許可權時再開啟。
* 需要依賴快取時，優先使用官方支援的快取方案（例如針對語言套件管理器的 cache 或 BuildKit cache）。

如果你需要在某個步驟裡直接執行容器映象（而不是建立映象），可以使用 `docker://` 語法：

```yaml
- name: Run container step
  uses: docker://golang:alpine
  with:
    args: go version
```

## 21.2.3 參考資料

* [Actions Docs](https://docs.github.com/en/actions)
